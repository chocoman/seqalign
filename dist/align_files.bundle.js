!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("seqalign",[],e):"object"==typeof exports?exports.seqalign=e():t.seqalign=e()}(this,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=12)}([function(t,e){function n(t,e){for(var n in t)e[n]=t[n]}function r(t,e){var r=t.prototype;if(!(r instanceof e)){function i(){}i.prototype=e.prototype,n(r,i=new i),t.prototype=r=i}r.constructor!=t&&("function"!=typeof t&&console.error("unknow Class:"+t),r.constructor=t)}var i="http://www.w3.org/1999/xhtml",s={},o=s.ELEMENT_NODE=1,a=s.ATTRIBUTE_NODE=2,u=s.TEXT_NODE=3,c=s.CDATA_SECTION_NODE=4,l=s.ENTITY_REFERENCE_NODE=5,h=s.ENTITY_NODE=6,d=s.PROCESSING_INSTRUCTION_NODE=7,f=s.COMMENT_NODE=8,m=s.DOCUMENT_NODE=9,p=s.DOCUMENT_TYPE_NODE=10,g=s.DOCUMENT_FRAGMENT_NODE=11,v=s.NOTATION_NODE=12,w={},y={},N=(w.INDEX_SIZE_ERR=(y[1]="Index size error",1),w.DOMSTRING_SIZE_ERR=(y[2]="DOMString size error",2),w.HIERARCHY_REQUEST_ERR=(y[3]="Hierarchy request error",3)),b=(w.WRONG_DOCUMENT_ERR=(y[4]="Wrong document",4),w.INVALID_CHARACTER_ERR=(y[5]="Invalid character",5),w.NO_DATA_ALLOWED_ERR=(y[6]="No data allowed",6),w.NO_MODIFICATION_ALLOWED_ERR=(y[7]="No modification allowed",7),w.NOT_FOUND_ERR=(y[8]="Not found",8)),x=(w.NOT_SUPPORTED_ERR=(y[9]="Not supported",9),w.INUSE_ATTRIBUTE_ERR=(y[10]="Attribute in use",10));w.INVALID_STATE_ERR=(y[11]="Invalid state",11),w.SYNTAX_ERR=(y[12]="Syntax error",12),w.INVALID_MODIFICATION_ERR=(y[13]="Invalid modification",13),w.NAMESPACE_ERR=(y[14]="Invalid namespace",14),w.INVALID_ACCESS_ERR=(y[15]="Invalid access",15);function S(t,e){if(e instanceof Error)var n=e;else n=this,Error.call(this,y[t]),this.message=y[t],Error.captureStackTrace&&Error.captureStackTrace(this,S);return n.code=t,e&&(this.message=this.message+": "+e),n}function D(){}function E(t,e){this._node=t,this._refresh=e,$(this)}function $(t){var e=t._node._inc||t._node.ownerDocument._inc;if(t._inc!=e){var r=t._refresh(t._node);nt(t,"length",r.length),n(r,t),t._inc=e}}function T(){}function M(t,e){for(var n=t.length;n--;)if(t[n]===e)return n}function I(t,e,n,r){if(r?e[M(e,r)]=n:e[e.length++]=n,t){n.ownerElement=t;var i=t.ownerDocument;i&&(r&&k(i,t,r),function(t,e,n){t&&t._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&(e._nsMap[n.prefix?n.localName:""]=n.value)}(i,t,n))}}function _(t,e,n){var r=M(e,n);if(!(r>=0))throw S(b,new Error(t.tagName+"@"+n));for(var i=e.length-1;r<i;)e[r]=e[++r];if(e.length=i,t){var s=t.ownerDocument;s&&(k(s,t,n),n.ownerElement=null)}}function A(t){if(this._features={},t)for(var e in t)this._features=t[e]}function C(){}function O(t){return("<"==t?"&lt;":">"==t&&"&gt;")||"&"==t&&"&amp;"||'"'==t&&"&quot;"||"&#"+t.charCodeAt()+";"}function P(t,e){if(e(t))return!0;if(t=t.firstChild)do{if(P(t,e))return!0}while(t=t.nextSibling)}function R(){}function k(t,e,n,r){t&&t._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&delete e._nsMap[n.prefix?n.localName:""]}function F(t,e,n){if(t&&t._inc){t._inc++;var r=e.childNodes;if(n)r[r.length++]=n;else{for(var i=e.firstChild,s=0;i;)r[s++]=i,i=i.nextSibling;r.length=s}}}function L(t,e){var n=e.previousSibling,r=e.nextSibling;return n?n.nextSibling=r:t.firstChild=r,r?r.previousSibling=n:t.lastChild=n,F(t.ownerDocument,t),e}function U(t,e,n){var r=e.parentNode;if(r&&r.removeChild(e),e.nodeType===g){var i=e.firstChild;if(null==i)return e;var s=e.lastChild}else i=s=e;var o=n?n.previousSibling:t.lastChild;i.previousSibling=o,s.nextSibling=n,o?o.nextSibling=i:t.firstChild=i,null==n?t.lastChild=s:n.previousSibling=s;do{i.parentNode=t}while(i!==s&&(i=i.nextSibling));return F(t.ownerDocument||t,t),e.nodeType==g&&(e.firstChild=e.lastChild=null),e}function B(){this._nsMap={}}function j(){}function q(){}function W(){}function H(){}function Y(){}function z(){}function V(){}function X(){}function Z(){}function G(){}function J(){}function Q(){}function K(t,e){var n=[],r=9==this.nodeType&&this.documentElement||this,i=r.prefix,s=r.namespaceURI;if(s&&null==i&&null==(i=r.lookupPrefix(s)))var o=[{namespace:s,prefix:null}];return et(this,n,t,e,o),n.join("")}function tt(t,e,n){var r=t.prefix||"",i=t.namespaceURI;if(!r&&!i)return!1;if("xml"===r&&"http://www.w3.org/XML/1998/namespace"===i||"http://www.w3.org/2000/xmlns/"==i)return!1;for(var s=n.length;s--;){var o=n[s];if(o.prefix==r)return o.namespace!=i}return!0}function et(t,e,n,r,s){if(r){if(!(t=r(t)))return;if("string"==typeof t)return void e.push(t)}switch(t.nodeType){case o:s||(s=[]);s.length;var h=t.attributes,v=h.length,w=t.firstChild,y=t.tagName;n=i===t.namespaceURI||n,e.push("<",y);for(var N=0;N<v;N++){"xmlns"==(b=h.item(N)).prefix?s.push({prefix:b.localName,namespace:b.value}):"xmlns"==b.nodeName&&s.push({prefix:"",namespace:b.value})}for(N=0;N<v;N++){var b;if(tt(b=h.item(N),0,s)){var x=b.prefix||"",S=b.namespaceURI,D=x?" xmlns:"+x:" xmlns";e.push(D,'="',S,'"'),s.push({prefix:x,namespace:S})}et(b,e,n,r,s)}if(tt(t,0,s)){x=t.prefix||"",S=t.namespaceURI,D=x?" xmlns:"+x:" xmlns";e.push(D,'="',S,'"'),s.push({prefix:x,namespace:S})}if(w||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(y)){if(e.push(">"),n&&/^script$/i.test(y))for(;w;)w.data?e.push(w.data):et(w,e,n,r,s),w=w.nextSibling;else for(;w;)et(w,e,n,r,s),w=w.nextSibling;e.push("</",y,">")}else e.push("/>");return;case m:case g:for(w=t.firstChild;w;)et(w,e,n,r,s),w=w.nextSibling;return;case a:return e.push(" ",t.name,'="',t.value.replace(/[<&"]/g,O),'"');case u:return e.push(t.data.replace(/[<&]/g,O));case c:return e.push("<![CDATA[",t.data,"]]>");case f:return e.push("\x3c!--",t.data,"--\x3e");case p:var E=t.publicId,$=t.systemId;if(e.push("<!DOCTYPE ",t.name),E)e.push(' PUBLIC "',E),$&&"."!=$&&e.push('" "',$),e.push('">');else if($&&"."!=$)e.push(' SYSTEM "',$,'">');else{var T=t.internalSubset;T&&e.push(" [",T,"]"),e.push(">")}return;case d:return e.push("<?",t.target," ",t.data,"?>");case l:return e.push("&",t.nodeName,";");default:e.push("??",t.nodeName)}}function nt(t,e,n){t[e]=n}S.prototype=Error.prototype,n(w,S),D.prototype={length:0,item:function(t){return this[t]||null},toString:function(t,e){for(var n=[],r=0;r<this.length;r++)et(this[r],n,t,e);return n.join("")}},E.prototype.item=function(t){return $(this),this[t]},r(E,D),T.prototype={length:0,item:D.prototype.item,getNamedItem:function(t){for(var e=this.length;e--;){var n=this[e];if(n.nodeName==t)return n}},setNamedItem:function(t){var e=t.ownerElement;if(e&&e!=this._ownerElement)throw new S(x);var n=this.getNamedItem(t.nodeName);return I(this._ownerElement,this,t,n),n},setNamedItemNS:function(t){var e,n=t.ownerElement;if(n&&n!=this._ownerElement)throw new S(x);return e=this.getNamedItemNS(t.namespaceURI,t.localName),I(this._ownerElement,this,t,e),e},removeNamedItem:function(t){var e=this.getNamedItem(t);return _(this._ownerElement,this,e),e},removeNamedItemNS:function(t,e){var n=this.getNamedItemNS(t,e);return _(this._ownerElement,this,n),n},getNamedItemNS:function(t,e){for(var n=this.length;n--;){var r=this[n];if(r.localName==e&&r.namespaceURI==t)return r}return null}},A.prototype={hasFeature:function(t,e){var n=this._features[t.toLowerCase()];return!(!n||e&&!(e in n))},createDocument:function(t,e,n){var r=new R;if(r.implementation=this,r.childNodes=new D,r.doctype=n,n&&r.appendChild(n),e){var i=r.createElementNS(t,e);r.appendChild(i)}return r},createDocumentType:function(t,e,n){var r=new z;return r.name=t,r.nodeName=t,r.publicId=e,r.systemId=n,r}},C.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(t,e){return U(this,t,e)},replaceChild:function(t,e){this.insertBefore(t,e),e&&this.removeChild(e)},removeChild:function(t){return L(this,t)},appendChild:function(t){return this.insertBefore(t,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(t){return function t(e,n,r){var i=new n.constructor;for(var s in n){var u=n[s];"object"!=typeof u&&u!=i[s]&&(i[s]=u)}n.childNodes&&(i.childNodes=new D);i.ownerDocument=e;switch(i.nodeType){case o:var c=n.attributes,l=i.attributes=new T,h=c.length;l._ownerElement=i;for(var d=0;d<h;d++)i.setAttributeNode(t(e,c.item(d),!0));break;case a:r=!0}if(r)for(var f=n.firstChild;f;)i.appendChild(t(e,f,r)),f=f.nextSibling;return i}(this.ownerDocument||this,this,t)},normalize:function(){for(var t=this.firstChild;t;){var e=t.nextSibling;e&&e.nodeType==u&&t.nodeType==u?(this.removeChild(e),t.appendData(e.data)):(t.normalize(),t=e)}},isSupported:function(t,e){return this.ownerDocument.implementation.hasFeature(t,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(t){for(var e=this;e;){var n=e._nsMap;if(n)for(var r in n)if(n[r]==t)return r;e=e.nodeType==a?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(t){for(var e=this;e;){var n=e._nsMap;if(n&&t in n)return n[t];e=e.nodeType==a?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(t){return null==this.lookupPrefix(t)}},n(s,C),n(s,C.prototype),R.prototype={nodeName:"#document",nodeType:m,doctype:null,documentElement:null,_inc:1,insertBefore:function(t,e){if(t.nodeType==g){for(var n=t.firstChild;n;){var r=n.nextSibling;this.insertBefore(n,e),n=r}return t}return null==this.documentElement&&t.nodeType==o&&(this.documentElement=t),U(this,t,e),t.ownerDocument=this,t},removeChild:function(t){return this.documentElement==t&&(this.documentElement=null),L(this,t)},importNode:function(t,e){return function t(e,n,r){var i;switch(n.nodeType){case o:(i=n.cloneNode(!1)).ownerDocument=e;case g:break;case a:r=!0}i||(i=n.cloneNode(!1));i.ownerDocument=e;i.parentNode=null;if(r)for(var s=n.firstChild;s;)i.appendChild(t(e,s,r)),s=s.nextSibling;return i}(this,t,e)},getElementById:function(t){var e=null;return P(this.documentElement,function(n){if(n.nodeType==o&&n.getAttribute("id")==t)return e=n,!0}),e},getElementsByClassName:function(t){const e=new RegExp(`(^|\\s)${t}(\\s|$)`);return new E(this,t=>{var n=[];return P(t.documentElement,r=>{r!==t&&r.nodeType==o&&e.test(r.getAttribute("class"))&&n.push(r)}),n})},createElement:function(t){var e=new B;return e.ownerDocument=this,e.nodeName=t,e.tagName=t,e.childNodes=new D,(e.attributes=new T)._ownerElement=e,e},createDocumentFragment:function(){var t=new G;return t.ownerDocument=this,t.childNodes=new D,t},createTextNode:function(t){var e=new W;return e.ownerDocument=this,e.appendData(t),e},createComment:function(t){var e=new H;return e.ownerDocument=this,e.appendData(t),e},createCDATASection:function(t){var e=new Y;return e.ownerDocument=this,e.appendData(t),e},createProcessingInstruction:function(t,e){var n=new J;return n.ownerDocument=this,n.tagName=n.target=t,n.nodeValue=n.data=e,n},createAttribute:function(t){var e=new j;return e.ownerDocument=this,e.name=t,e.nodeName=t,e.localName=t,e.specified=!0,e},createEntityReference:function(t){var e=new Z;return e.ownerDocument=this,e.nodeName=t,e},createElementNS:function(t,e){var n=new B,r=e.split(":"),i=n.attributes=new T;return n.childNodes=new D,n.ownerDocument=this,n.nodeName=e,n.tagName=e,n.namespaceURI=t,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=e,i._ownerElement=n,n},createAttributeNS:function(t,e){var n=new j,r=e.split(":");return n.ownerDocument=this,n.nodeName=e,n.name=e,n.namespaceURI=t,n.specified=!0,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=e,n}},r(R,C),B.prototype={nodeType:o,hasAttribute:function(t){return null!=this.getAttributeNode(t)},getAttribute:function(t){var e=this.getAttributeNode(t);return e&&e.value||""},getAttributeNode:function(t){return this.attributes.getNamedItem(t)},setAttribute:function(t,e){var n=this.ownerDocument.createAttribute(t);n.value=n.nodeValue=""+e,this.setAttributeNode(n)},removeAttribute:function(t){var e=this.getAttributeNode(t);e&&this.removeAttributeNode(e)},appendChild:function(t){return t.nodeType===g?this.insertBefore(t,null):function(t,e){var n=e.parentNode;if(n){var r=t.lastChild;n.removeChild(e),r=t.lastChild}return r=t.lastChild,e.parentNode=t,e.previousSibling=r,e.nextSibling=null,r?r.nextSibling=e:t.firstChild=e,t.lastChild=e,F(t.ownerDocument,t,e),e}(this,t)},setAttributeNode:function(t){return this.attributes.setNamedItem(t)},setAttributeNodeNS:function(t){return this.attributes.setNamedItemNS(t)},removeAttributeNode:function(t){return this.attributes.removeNamedItem(t.nodeName)},removeAttributeNS:function(t,e){var n=this.getAttributeNodeNS(t,e);n&&this.removeAttributeNode(n)},hasAttributeNS:function(t,e){return null!=this.getAttributeNodeNS(t,e)},getAttributeNS:function(t,e){var n=this.getAttributeNodeNS(t,e);return n&&n.value||""},setAttributeNS:function(t,e,n){var r=this.ownerDocument.createAttributeNS(t,e);r.value=r.nodeValue=""+n,this.setAttributeNode(r)},getAttributeNodeNS:function(t,e){return this.attributes.getNamedItemNS(t,e)},getElementsByTagName:function(t){return new E(this,function(e){var n=[];return P(e,function(r){r===e||r.nodeType!=o||"*"!==t&&r.tagName!=t||n.push(r)}),n})},getElementsByTagNameNS:function(t,e){return new E(this,function(n){var r=[];return P(n,function(i){i===n||i.nodeType!==o||"*"!==t&&i.namespaceURI!==t||"*"!==e&&i.localName!=e||r.push(i)}),r})}},R.prototype.getElementsByTagName=B.prototype.getElementsByTagName,R.prototype.getElementsByTagNameNS=B.prototype.getElementsByTagNameNS,r(B,C),j.prototype.nodeType=a,r(j,C),q.prototype={data:"",substringData:function(t,e){return this.data.substring(t,t+e)},appendData:function(t){t=this.data+t,this.nodeValue=this.data=t,this.length=t.length},insertData:function(t,e){this.replaceData(t,0,e)},appendChild:function(t){throw new Error(y[N])},deleteData:function(t,e){this.replaceData(t,e,"")},replaceData:function(t,e,n){n=this.data.substring(0,t)+n+this.data.substring(t+e),this.nodeValue=this.data=n,this.length=n.length}},r(q,C),W.prototype={nodeName:"#text",nodeType:u,splitText:function(t){var e=this.data,n=e.substring(t);e=e.substring(0,t),this.data=this.nodeValue=e,this.length=e.length;var r=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}},r(W,q),H.prototype={nodeName:"#comment",nodeType:f},r(H,q),Y.prototype={nodeName:"#cdata-section",nodeType:c},r(Y,q),z.prototype.nodeType=p,r(z,C),V.prototype.nodeType=v,r(V,C),X.prototype.nodeType=h,r(X,C),Z.prototype.nodeType=l,r(Z,C),G.prototype.nodeName="#document-fragment",G.prototype.nodeType=g,r(G,C),J.prototype.nodeType=d,r(J,C),Q.prototype.serializeToString=function(t,e,n){return K.call(t,e,n)},C.prototype.toString=K;try{if(Object.defineProperty){Object.defineProperty(E.prototype,"length",{get:function(){return $(this),this.$$length}}),Object.defineProperty(C.prototype,"textContent",{get:function(){return function t(e){switch(e.nodeType){case o:case g:var n=[];for(e=e.firstChild;e;)7!==e.nodeType&&8!==e.nodeType&&n.push(t(e)),e=e.nextSibling;return n.join("");default:return e.nodeValue}}(this)},set:function(t){switch(this.nodeType){case o:case g:for(;this.firstChild;)this.removeChild(this.firstChild);(t||String(t))&&this.appendChild(this.ownerDocument.createTextNode(t));break;default:this.data=t,this.value=t,this.nodeValue=t}}}),nt=function(t,e,n){t["$$"+e]=n}}}catch(t){}e.Node=C,e.DOMImplementation=A,e.XMLSerializer=Q},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Counter=void 0;e.Counter=class{constructor(){this.dictionary={}}increment(t,e){this.dictionary[t]||(this.dictionary[t]=0),this.dictionary[t]+=e,0===this.dictionary[t]&&delete this.dictionary[t]}get(t){return this.dictionary[t]?this.dictionary[t]:0}getIntersectSize(t){let e=0;for(let n in this.dictionary)e+=Math.min(this.get(n),t.get(n));return e}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Alignment=void 0;const r=n(1);var i;!function(t){t[t.Begin=0]="Begin",t[t.Insert=1]="Insert",t[t.Substitute=2]="Substitute",t[t.Match=3]="Match",t[t.Delete=4]="Delete"}(i||(i={}));const s=15;class o{constructor(t,e,n,r,i){this.a=t,this.distance=e,this.insertionPenalty=n,this.deletionPenalty=r,this.chunkSize=i}static pickBestMatchFromScores(t){const e=Math.max(...t),n=t.indexOf(e);var r=t.reduce((t,n,r)=>(n>=.5*e&&t.push(r),t),[]);const i=r[0];return r[r.length-1]-i>s?null:e<.7*s?null:n}push(t){this.a.push(t)}findBestMatchForPattern(t,e,n){const i=new r.Counter,a=new r.Counter;for(let n=0;n<t.length;n+=1)i.increment(t[n],1),a.increment(this.a[e+n],1);const u=[];for(let r=e;r<n-t.length;r+=1){const e=a.getIntersectSize(i);u.push(e),a.increment(this.a[r],-1),a.increment(this.a[r+t.length],1)}const c=o.pickBestMatchFromScores(u);if(null===c)return[null,null];const l=e+c,[h,d]=this.getMatchingWords(t,this.a.slice(l,l+s));return null===h?[null,null]:[h,l+d]}getCountInArray(t,e){let n=0;for(let r=0;r<e.length;r+=1)e[r]===t&&(n+=1);return n}getMatchingWords(t,e){for(let n=0;n<t.length;n+=1)for(let r=Math.max(0,n-2);r<Math.min(e.length,n+3);r+=1)if(t[n]===e[r]&&1===this.getCountInArray(t[n],t)&&1===this.getCountInArray(e[r],e))return[n,r];return[null,null]}getPivots(t,e,n){const r=Math.floor(.5*t.length),i=Math.floor(.8*t.length),o=Math.floor(3*s);for(let s=r;s<i;s+=o){const[r,i]=this.getPivotsAt(t,e,n,s);if(null!==r)return[r,i]}throw new Error("no match found")}getPivotsAt(t,e,n,r){const i=r+s,o=t.slice(r,i).map(t=>t.trim()),[a,u]=this.findBestMatchForPattern(o,e,n);return null===a?[null,null]:[r+a,u]}match(t,e,n){if(n-e>this.chunkSize&&t.length>this.chunkSize){const[r,i]=this.getPivots(t,e,n),{distance:s,matchIndices:o}=this.match(t.slice(0,r),e,i),{distance:a,matchIndices:u}=this.match(t.slice(r),i,n);return{distance:s+a,matchIndices:o.concat(u)}}const r=[],s=[],o=this.a.slice(e,n);for(let e=0;e<=t.length;e++)r[e]=[],s[e]=[];r[0][0]=0,s[0][0]=i.Begin;for(let t=1;t<=o.length;t++)r[0][t]=r[0][t-1]+this.insertionPenalty(o[t-1],null),s[0][t]=i.Begin;for(let e=1;e<=t.length;e++)r[e][0]=r[e-1][0]+this.deletionPenalty(t[e-1]),s[e][0]=i.Delete;for(let e=1;e<=t.length;e++)for(let n=1;n<=o.length;n++){const l=this.distance(t[e-1],o[n-1]);var a=r[e-1][n-1]+l,u=r[e][n-1]+this.insertionPenalty(o[n-1],t[e-1]),c=r[e-1][n]+this.deletionPenalty(t[e-1]);a<u&&a<c?(r[e][n]=a,s[e][n]=0===l?i.Match:i.Substitute):u<c?(r[e][n]=u,s[e][n]=i.Insert):(r[e][n]=c,s[e][n]=i.Delete)}let l=t.length,h=o.length,d=s[l][h];const f=new Array(t.length).fill(0);for(var m=0;d!==i.Begin&&!(l<0||h<0);m++)d===i.Substitute?(l-=1,h-=1):d===i.Delete?(l-=1,h=h):d===i.Insert?(l=l,h-=1):d===i.Match&&(l-=1,h-=1),d!==i.Insert&&(f[l]=e+Math.min(h,o.length-1)),d=s[l][h];return{distance:r[t.length][o.length],matchIndices:f}}}e.Alignment=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Transcription=void 0;const r=n(9),i=n(8),s=n(7);r.extend(i.default);const o=n(6).DOMParser,a='<?xml version="1.0" encoding="utf-8" standalone="yes"?>\n<transcription version="3.0">\n  <meta>\n  </meta>\n  <ch name="">\n    <se name="0">\n      <pa b="PT0S" e="PT20H0M0S" s="0">\n',u="\n      </pa>\n    </se>\n  </ch>\n  <sp>\n  </sp>\n</transcription>\n";e.Transcription=class{constructor(t,e){this.words=[],this.timestamps=[],this.length=0,this.text="",t&&this.fromTrsx(t,e)}loadPhraseRaw(t,e,n){this.text+=t;const r=t.split(" ");if(0===t.length)this.words.push(""),this.timestamps.push([e,n]);else for(let t=0;t<r.length;t+=1)0!==r[t].length&&(this.words.push(r[t]),this.length+=1,this.timestamps.push([e,n]))}loadPhraseXml(t,e){const n=t.textContent,i=r.duration(t.getAttribute("b")).asSeconds(),s=r.duration(t.getAttribute("e")).asSeconds();(!e||"[n::"!==n.substring(0,4)&&"[h::"!==n.substring(0,4))&&this.loadPhraseRaw(n,i,s)}fromTrsx(t,e){const n=(new o).parseFromString(t,"text/xml").getElementsByTagName("pa");for(let t=0;t<n.length;t+=1){const r=n[t].getElementsByTagName("p");for(let t=0;t<r.length;t+=1)this.loadPhraseXml(r[t],e);this.words[this.words.length-1]+="\n",this.text+="\n"}}exportTrsx(){const t=[];for(let e=0;e<this.words.length;e+=1){let n=this.words[e]+" ";const[i,o]=this.timestamps[e];for(let t=e+1;t<this.timestamps.length&&this.timestamps[t][0]===i;t+=1)n+=this.words[t]+" ",e=t;const a=`        <p b="${r.duration(i,"seconds").toISOString()}" e="${r.duration(o,"seconds").toISOString()}">${s.escapeXMLString(n)}</p>\n`;t.push(a)}return[a,...t,u].join("")}getText(){return this.text}}},function(t,e){var n=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,r=new RegExp("[\\-\\.0-9"+n.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),i=new RegExp("^"+n.source+r.source+"*(?::"+n.source+r.source+"*)?$"),s=0,o=1,a=2,u=3,c=4,l=5,h=6,d=7;function f(){}function m(t,e){return e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber,e}function p(t,e,n,r,i,f){for(var m,p=++e,g=s;;){var v=t.charAt(p);switch(v){case"=":if(g===o)m=t.slice(e,p),g=u;else{if(g!==a)throw new Error("attribute equal must after attrName");g=u}break;case"'":case'"':if(g===u||g===o){if(g===o&&(f.warning('attribute value must after "="'),m=t.slice(e,p)),e=p+1,!((p=t.indexOf(v,e))>0))throw new Error("attribute value no end '"+v+"' match");w=t.slice(e,p).replace(/&#?\w+;/g,i),n.add(m,w,e-1),g=l}else{if(g!=c)throw new Error('attribute value must after "="');w=t.slice(e,p).replace(/&#?\w+;/g,i),n.add(m,w,e),f.warning('attribute "'+m+'" missed start quot('+v+")!!"),e=p+1,g=l}break;case"/":switch(g){case s:n.setTagName(t.slice(e,p));case l:case h:case d:g=d,n.closed=!0;case c:case o:case a:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return f.error("unexpected end of input"),g==s&&n.setTagName(t.slice(e,p)),p;case">":switch(g){case s:n.setTagName(t.slice(e,p));case l:case h:case d:break;case c:case o:"/"===(w=t.slice(e,p)).slice(-1)&&(n.closed=!0,w=w.slice(0,-1));case a:g===a&&(w=m),g==c?(f.warning('attribute "'+w+'" missed quot(")!!'),n.add(m,w.replace(/&#?\w+;/g,i),e)):("http://www.w3.org/1999/xhtml"===r[""]&&w.match(/^(?:disabled|checked|selected)$/i)||f.warning('attribute "'+w+'" missed value!! "'+w+'" instead!!'),n.add(w,w,e));break;case u:throw new Error("attribute value missed!!")}return p;case"":v=" ";default:if(v<=" ")switch(g){case s:n.setTagName(t.slice(e,p)),g=h;break;case o:m=t.slice(e,p),g=a;break;case c:var w=t.slice(e,p).replace(/&#?\w+;/g,i);f.warning('attribute "'+w+'" missed quot(")!!'),n.add(m,w,e);case l:g=h}else switch(g){case a:n.tagName;"http://www.w3.org/1999/xhtml"===r[""]&&m.match(/^(?:disabled|checked|selected)$/i)||f.warning('attribute "'+m+'" missed value!! "'+m+'" instead2!!'),n.add(m,m,e),e=p,g=o;break;case l:f.warning('attribute space is required"'+m+'"!!');case h:g=o,e=p;break;case u:g=c,e=p;break;case d:throw new Error("elements closed character '/' and '>' must be connected to")}}p++}}function g(t,e,n){for(var r=t.tagName,i=null,s=t.length;s--;){var o=t[s],a=o.qName,u=o.value;if((d=a.indexOf(":"))>0)var c=o.prefix=a.slice(0,d),l=a.slice(d+1),h="xmlns"===c&&l;else l=a,c=null,h="xmlns"===a&&"";o.localName=l,!1!==h&&(null==i&&(i={},y(n,n={})),n[h]=i[h]=u,o.uri="http://www.w3.org/2000/xmlns/",e.startPrefixMapping(h,u))}for(s=t.length;s--;){(c=(o=t[s]).prefix)&&("xml"===c&&(o.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==c&&(o.uri=n[c||""]))}var d;(d=r.indexOf(":"))>0?(c=t.prefix=r.slice(0,d),l=t.localName=r.slice(d+1)):(c=null,l=t.localName=r);var f=t.uri=n[c||""];if(e.startElement(f,l,r,t),!t.closed)return t.currentNSMap=n,t.localNSMap=i,!0;if(e.endElement(f,l,r),i)for(c in i)e.endPrefixMapping(c)}function v(t,e,n,r,i){if(/^(?:script|textarea)$/i.test(n)){var s=t.indexOf("</"+n+">",e),o=t.substring(e+1,s);if(/[&<]/.test(o))return/^script$/i.test(n)?(i.characters(o,0,o.length),s):(o=o.replace(/&#?\w+;/g,r),i.characters(o,0,o.length),s)}return e+1}function w(t,e,n,r){var i=r[n];return null==i&&((i=t.lastIndexOf("</"+n+">"))<e&&(i=t.lastIndexOf("</"+n)),r[n]=i),i<e}function y(t,e){for(var n in t)e[n]=t[n]}function N(t,e,n,r){switch(t.charAt(e+2)){case"-":return"-"===t.charAt(e+3)?(i=t.indexOf("--\x3e",e+4))>e?(n.comment(t,e+4,i-e-4),i+3):(r.error("Unclosed comment"),-1):-1;default:if("CDATA["==t.substr(e+3,6)){var i=t.indexOf("]]>",e+9);return n.startCDATA(),n.characters(t,e+9,i-e-9),n.endCDATA(),i+3}var s=function(t,e){var n,r=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;i.lastIndex=e,i.exec(t);for(;n=i.exec(t);)if(r.push(n),n[1])return r}(t,e),o=s.length;if(o>1&&/!doctype/i.test(s[0][0])){var a=s[1][0],u=o>3&&/^public$/i.test(s[2][0])&&s[3][0],c=o>4&&s[4][0],l=s[o-1];return n.startDTD(a,u&&u.replace(/^(['"])(.*?)\1$/,"$2"),c&&c.replace(/^(['"])(.*?)\1$/,"$2")),n.endDTD(),l.index+l[0].length}}return-1}function b(t,e,n){var r=t.indexOf("?>",e);if(r){var i=t.substring(e,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(i){i[0].length;return n.processingInstruction(i[1],i[2]),r+2}return-1}return-1}function x(t){}f.prototype={parse:function(t,e,n){var r=this.domBuilder;r.startDocument(),y(e,e={}),function(t,e,n,r,i){function s(t){var e=t.slice(1,-1);return e in n?n[e]:"#"===e.charAt(0)?function(t){if(t>65535){var e=55296+((t-=65536)>>10),n=56320+(1023&t);return String.fromCharCode(e,n)}return String.fromCharCode(t)}(parseInt(e.substr(1).replace("x","0x"))):(i.error("entity not found:"+t),t)}function o(e){if(e>y){var n=t.substring(y,e).replace(/&#?\w+;/g,s);h&&a(y),r.characters(n,0,e-y),y=e}}function a(e,n){for(;e>=c&&(n=l.exec(t));)u=n.index,c=u+n[0].length,h.lineNumber++;h.columnNumber=e-u+1}var u=0,c=0,l=/.*(?:\r\n?|\n)|.*$/g,h=r.locator,d=[{currentNSMap:e}],f={},y=0;for(;;){try{var S=t.indexOf("<",y);if(S<0){if(!t.substr(y).match(/^\s*$/)){var D=r.doc,E=D.createTextNode(t.substr(y));D.appendChild(E),r.currentElement=E}return}switch(S>y&&o(S),t.charAt(S+1)){case"/":var $=t.indexOf(">",S+3),T=t.substring(S+2,$),M=d.pop();$<0?(T=t.substring(S+2).replace(/[\s<].*/,""),i.error("end tag name: "+T+" is not complete:"+M.tagName),$=S+1+T.length):T.match(/\s</)&&(T=T.replace(/[\s<].*/,""),i.error("end tag name: "+T+" maybe not complete"),$=S+1+T.length);var I=M.localNSMap,_=M.tagName==T,A=_||M.tagName&&M.tagName.toLowerCase()==T.toLowerCase();if(A){if(r.endElement(M.uri,M.localName,T),I)for(var C in I)r.endPrefixMapping(C);_||i.fatalError("end tag name: "+T+" is not match the current start tagName:"+M.tagName)}else d.push(M);$++;break;case"?":h&&a(S),$=b(t,S,r);break;case"!":h&&a(S),$=N(t,S,r,i);break;default:h&&a(S);var O=new x,P=d[d.length-1].currentNSMap,$=p(t,S,O,P,s,i),R=O.length;if(!O.closed&&w(t,$,O.tagName,f)&&(O.closed=!0,n.nbsp||i.warning("unclosed xml attribute")),h&&R){for(var k=m(h,{}),F=0;F<R;F++){var L=O[F];a(L.offset),L.locator=m(h,{})}r.locator=k,g(O,r,P)&&d.push(O),r.locator=h}else g(O,r,P)&&d.push(O);"http://www.w3.org/1999/xhtml"!==O.uri||O.closed?$++:$=v(t,$,O.tagName,s,r)}}catch(t){i.error("element parse error: "+t),$=-1}$>y?y=$:o(Math.max(S,y)+1)}}(t,e,n,r,this.errorHandler),r.endDocument()}},x.prototype={setTagName:function(t){if(!i.test(t))throw new Error("invalid tagName:"+t);this.tagName=t},add:function(t,e,n){if(!i.test(t))throw new Error("invalid attribute:"+t);this[this.length++]={qName:t,value:e,offset:n}},length:0,getLocalName:function(t){return this[t].localName},getLocator:function(t){return this[t].locator},getQName:function(t){return this[t].qName},getURI:function(t){return this[t].uri},getValue:function(t){return this[t].value}},e.XMLReader=f},function(t,e){e.entityMap={lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",auml:"ä",Aring:"Å",aring:"å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",ouml:"ö",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",times:"×",divide:"÷",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",euro:"€",trade:"™",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦"}},function(t,e,n){function r(t){this.options=t||{locator:{}}}function i(){this.cdata=!1}function s(t,e){e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber}function o(t){if(t)return"\n@"+(t.systemId||"")+"#[line:"+t.lineNumber+",col:"+t.columnNumber+"]"}function a(t,e,n){return"string"==typeof t?t.substr(e,n):t.length>=e+n||e?new java.lang.String(t,e,n)+"":t}function u(t,e){t.currentElement?t.currentElement.appendChild(e):t.doc.appendChild(e)}r.prototype.parseFromString=function(t,e){var n=this.options,r=new l,s=n.domBuilder||new i,a=n.errorHandler,u=n.locator,h=n.xmlns||{},d=/\/x?html?$/.test(e),f=d?c.entityMap:{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return u&&s.setDocumentLocator(u),r.errorHandler=function(t,e,n){if(!t){if(e instanceof i)return e;t=e}var r={},s=t instanceof Function;function a(e){var i=t[e];!i&&s&&(i=2==t.length?function(n){t(e,n)}:t),r[e]=i&&function(t){i("[xmldom "+e+"]\t"+t+o(n))}||function(){}}return n=n||{},a("warning"),a("error"),a("fatalError"),r}(a,s,u),r.domBuilder=n.domBuilder||s,d&&(h[""]="http://www.w3.org/1999/xhtml"),h.xml=h.xml||"http://www.w3.org/XML/1998/namespace",t?r.parse(t,h,f):r.errorHandler.error("invalid doc source"),s.doc},i.prototype={startDocument:function(){this.doc=(new h).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(t,e,n,r){var i=this.doc,o=i.createElementNS(t,n||e),a=r.length;u(this,o),this.currentElement=o,this.locator&&s(this.locator,o);for(var c=0;c<a;c++){t=r.getURI(c);var l=r.getValue(c),h=(n=r.getQName(c),i.createAttributeNS(t,n));this.locator&&s(r.getLocator(c),h),h.value=h.nodeValue=l,o.setAttributeNode(h)}},endElement:function(t,e,n){var r=this.currentElement;r.tagName;this.currentElement=r.parentNode},startPrefixMapping:function(t,e){},endPrefixMapping:function(t){},processingInstruction:function(t,e){var n=this.doc.createProcessingInstruction(t,e);this.locator&&s(this.locator,n),u(this,n)},ignorableWhitespace:function(t,e,n){},characters:function(t,e,n){if(t=a.apply(this,arguments)){if(this.cdata)var r=this.doc.createCDATASection(t);else r=this.doc.createTextNode(t);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(t)&&this.doc.appendChild(r),this.locator&&s(this.locator,r)}},skippedEntity:function(t){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(t){(this.locator=t)&&(t.lineNumber=0)},comment:function(t,e,n){t=a.apply(this,arguments);var r=this.doc.createComment(t);this.locator&&s(this.locator,r),u(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(t,e,n){var r=this.doc.implementation;if(r&&r.createDocumentType){var i=r.createDocumentType(t,e,n);this.locator&&s(this.locator,i),u(this,i)}},warning:function(t){console.warn("[xmldom warning]\t"+t,o(this.locator))},error:function(t){console.error("[xmldom error]\t"+t,o(this.locator))},fatalError:function(t){throw console.error("[xmldom fatalError]\t"+t,o(this.locator)),t}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(t){i.prototype[t]=function(){return null}});var c=n(5),l=n(4).XMLReader,h=e.DOMImplementation=n(0).DOMImplementation;e.XMLSerializer=n(0).XMLSerializer,e.DOMParser=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.unescapeXMLString=e.escapeXMLString=void 0;const r={'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;","&":"&amp;"},i={"&quot;":'"',"&apos;":"'","&lt;":"<","&gt;":">","&amp;":"&"},s=new RegExp(Object.keys(r).join("|"),"g"),o=new RegExp(Object.keys(i).join("|"),"g");e.escapeXMLString=(t=>t.replace(s,t=>r[t])),e.unescapeXMLString=(t=>t.replace(o,t=>i[t]))},function(t,e,n){t.exports=function(){"use strict";var t,e,n=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,r={years:31536e6,months:2592e6,days:864e5,hours:36e5,minutes:6e4,seconds:1e3,milliseconds:1,weeks:6048e5},i=function(t){return t instanceof a},s=function(t,e,n){return new a(t,n,e.$l)},o=function(t){return e.p(t)+"s"},a=function(){function e(t,e,i){var a=this;if(this.$d={},this.$l=i,e)return s(t*r[o(e)],this);if("number"==typeof t)return this.$ms=t,this.parseFromMilliseconds(),this;if("object"==typeof t)return Object.keys(t).forEach(function(e){a.$d[o(e)]=t[e]}),this.calMilliseconds(),this;if("string"==typeof t){var u=t.match(n);if(u)return this.$d.years=u[2],this.$d.months=u[3],this.$d.weeks=u[4],this.$d.days=u[5],this.$d.hours=u[6],this.$d.minutes=u[7],this.$d.seconds=u[8],this.calMilliseconds(),this}return this}var a=e.prototype;return a.calMilliseconds=function(){var t=this;this.$ms=Object.keys(this.$d).reduce(function(e,n){return e+(t.$d[n]||0)*r[n]},0)},a.parseFromMilliseconds=function(){var t=this.$ms;this.$d.years=Math.floor(t/31536e6),t%=31536e6,this.$d.months=Math.floor(t/2592e6),t%=2592e6,this.$d.days=Math.floor(t/864e5),t%=864e5,this.$d.hours=Math.floor(t/36e5),t%=36e5,this.$d.minutes=Math.floor(t/6e4),t%=6e4,this.$d.seconds=Math.floor(t/1e3),t%=1e3,this.$d.milliseconds=t},a.toISOString=function(){var t=this.$d.years?this.$d.years+"Y":"",e=this.$d.months?this.$d.months+"M":"",n=+this.$d.days||0;this.$d.weeks&&(n+=7*this.$d.weeks);var r=n?n+"D":"",i=this.$d.hours?this.$d.hours+"H":"",s=this.$d.minutes?this.$d.minutes+"M":"",o=this.$d.seconds||0;this.$d.milliseconds&&(o+=this.$d.milliseconds/1e3);var a=o?o+"S":"",u="P"+t+e+r+(i||s||a?"T":"")+i+s+a;return"P"===u?"P0D":u},a.toJSON=function(){return this.toISOString()},a.as=function(t){return this.$ms/r[o(t)]},a.get=function(t){var e=this.$ms,n=o(t);return"milliseconds"===n?e%=1e3:e="weeks"===n?Math.floor(e/r[n]):this.$d[n],e},a.add=function(t,e,n){var a;return a=e?t*r[o(e)]:i(t)?t.$ms:s(t,this).$ms,s(this.$ms+a*(n?-1:1),this)},a.subtract=function(t,e){return this.add(t,e,!0)},a.locale=function(t){var e=this.clone();return e.$l=t,e},a.clone=function(){return s(this.$ms,this)},a.humanize=function(e){return t().add(this.$ms,"ms").locale(this.$l).fromNow(!e)},a.milliseconds=function(){return this.get("milliseconds")},a.asMilliseconds=function(){return this.as("milliseconds")},a.seconds=function(){return this.get("seconds")},a.asSeconds=function(){return this.as("seconds")},a.minutes=function(){return this.get("minutes")},a.asMinutes=function(){return this.as("minutes")},a.hours=function(){return this.get("hours")},a.asHours=function(){return this.as("hours")},a.days=function(){return this.get("days")},a.asDays=function(){return this.as("days")},a.weeks=function(){return this.get("weeks")},a.asWeeks=function(){return this.as("weeks")},a.months=function(){return this.get("months")},a.asMonths=function(){return this.as("months")},a.years=function(){return this.get("years")},a.asYears=function(){return this.as("years")},e}();return function(n,r,o){t=o,e=o().$utils(),o.duration=function(t,e){var n=o.locale();return s(t,{$l:n},e)},o.isDuration=i;var a=r.prototype.add;r.prototype.add=function(t,e){return i(t)&&(t=t.asMilliseconds(),e="ms"),a.bind(this)(t,e)}}}()},function(t,e,n){t.exports=function(){"use strict";var t="millisecond",e="second",n="minute",r="hour",i="day",s="week",o="month",a="quarter",u="year",c="date",l=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d+)?$/,h=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,d={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},f=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},m={s:f,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?"+":"-")+f(r,2,"0")+":"+f(i,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,o),s=n-i<0,a=e.clone().add(r+(s?-1:1),o);return+(-(r+(n-i)/(s?i-a:a-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(l){return{M:o,y:u,w:s,d:i,D:c,h:r,m:n,s:e,ms:t,Q:a}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},p="en",g={};g[p]=d;var v=function(t){return t instanceof b},w=function(t,e,n){var r;if(!t)return p;if("string"==typeof t)g[t]&&(r=t),e&&(g[t]=e,r=t);else{var i=t.name;g[i]=t,r=i}return!n&&r&&(p=r),r||!n&&p},y=function(t,e){if(v(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new b(n)},N=m;N.l=w,N.i=v,N.w=function(t,e){return y(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var b=function(){function d(t){this.$L=this.$L||w(t.locale,null,!0),this.parse(t)}var f=d.prototype;return f.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(N.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(l);if(r){var i=r[2]-1||0,s=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},f.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},f.$utils=function(){return N},f.isValid=function(){return!("Invalid Date"===this.$d.toString())},f.isSame=function(t,e){var n=y(t);return this.startOf(e)<=n&&n<=this.endOf(e)},f.isAfter=function(t,e){return y(t)<this.startOf(e)},f.isBefore=function(t,e){return this.endOf(e)<y(t)},f.$g=function(t,e,n){return N.u(t)?this[e]:this.set(n,t)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(t,a){var l=this,h=!!N.u(a)||a,d=N.p(t),f=function(t,e){var n=N.w(l.$u?Date.UTC(l.$y,e,t):new Date(l.$y,e,t),l);return h?n:n.endOf(i)},m=function(t,e){return N.w(l.toDate()[t].apply(l.toDate("s"),(h?[0,0,0,0]:[23,59,59,999]).slice(e)),l)},p=this.$W,g=this.$M,v=this.$D,w="set"+(this.$u?"UTC":"");switch(d){case u:return h?f(1,0):f(31,11);case o:return h?f(1,g):f(0,g+1);case s:var y=this.$locale().weekStart||0,b=(p<y?p+7:p)-y;return f(h?v-b:v+(6-b),g);case i:case c:return m(w+"Hours",0);case r:return m(w+"Minutes",1);case n:return m(w+"Seconds",2);case e:return m(w+"Milliseconds",3);default:return this.clone()}},f.endOf=function(t){return this.startOf(t,!1)},f.$set=function(s,a){var l,h=N.p(s),d="set"+(this.$u?"UTC":""),f=(l={},l[i]=d+"Date",l[c]=d+"Date",l[o]=d+"Month",l[u]=d+"FullYear",l[r]=d+"Hours",l[n]=d+"Minutes",l[e]=d+"Seconds",l[t]=d+"Milliseconds",l)[h],m=h===i?this.$D+(a-this.$W):a;if(h===o||h===u){var p=this.clone().set(c,1);p.$d[f](m),p.init(),this.$d=p.set(c,Math.min(this.$D,p.daysInMonth())).$d}else f&&this.$d[f](m);return this.init(),this},f.set=function(t,e){return this.clone().$set(t,e)},f.get=function(t){return this[N.p(t)]()},f.add=function(t,a){var c,l=this;t=Number(t);var h=N.p(a),d=function(e){var n=y(l);return N.w(n.date(n.date()+Math.round(e*t)),l)};if(h===o)return this.set(o,this.$M+t);if(h===u)return this.set(u,this.$y+t);if(h===i)return d(1);if(h===s)return d(7);var f=(c={},c[n]=6e4,c[r]=36e5,c[e]=1e3,c)[h]||1,m=this.$d.getTime()+t*f;return N.w(m,this)},f.subtract=function(t,e){return this.add(-1*t,e)},f.format=function(t){var e=this;if(!this.isValid())return"Invalid Date";var n=t||"YYYY-MM-DDTHH:mm:ssZ",r=N.z(this),i=this.$locale(),s=this.$H,o=this.$m,a=this.$M,u=i.weekdays,c=i.months,l=function(t,r,i,s){return t&&(t[r]||t(e,n))||i[r].substr(0,s)},d=function(t){return N.s(s%12||12,t,"0")},f=i.meridiem||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r},m={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:N.s(a+1,2,"0"),MMM:l(i.monthsShort,a,c,3),MMMM:l(c,a),D:this.$D,DD:N.s(this.$D,2,"0"),d:String(this.$W),dd:l(i.weekdaysMin,this.$W,u,2),ddd:l(i.weekdaysShort,this.$W,u,3),dddd:u[this.$W],H:String(s),HH:N.s(s,2,"0"),h:d(1),hh:d(2),a:f(s,o,!0),A:f(s,o,!1),m:String(o),mm:N.s(o,2,"0"),s:String(this.$s),ss:N.s(this.$s,2,"0"),SSS:N.s(this.$ms,3,"0"),Z:r};return n.replace(h,function(t,e){return e||m[t]||r.replace(":","")})},f.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},f.diff=function(t,c,l){var h,d=N.p(c),f=y(t),m=6e4*(f.utcOffset()-this.utcOffset()),p=this-f,g=N.m(this,f);return g=(h={},h[u]=g/12,h[o]=g,h[a]=g/3,h[s]=(p-m)/6048e5,h[i]=(p-m)/864e5,h[r]=p/36e5,h[n]=p/6e4,h[e]=p/1e3,h)[d]||p,l?g:N.a(g)},f.daysInMonth=function(){return this.endOf(o).$D},f.$locale=function(){return g[this.$L]},f.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=w(t,e,!0);return r&&(n.$L=r),n},f.clone=function(){return N.w(this.$d,this)},f.toDate=function(){return new Date(this.valueOf())},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},d}(),x=b.prototype;return y.prototype=x,[["$ms",t],["$s",e],["$m",n],["$H",r],["$W",i],["$M",o],["$y",u],["$D",c]].forEach(function(t){x[t[1]]=function(e){return this.$g(e,t[0],t[1])}}),y.extend=function(t,e){return t(e,b,y),y},y.locale=w,y.isDayjs=v,y.unix=function(t){return y(1e3*t)},y.en=g[p],y.Ls=g,y}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StringAligner=void 0;const r=n(2),i=n(3);let s=(()=>{class t{constructor(t,e,n,i,s,o,a){this.wordInsertionPenalty=((t,e)=>{const n=this.insertionPenalty*t.length;if(!e)return this.insertBetweenParagraphsPenalty*n;if(e.length>0){if("\n"===e[e.length-1])return this.insertBetweenParagraphsPenalty*n}return n}),this.wordDeletionPenalty=(t=>this.deletionPenalty*t.length),this.prefixDistance=((t,e)=>{let n;const r=Math.min(t.length,e.length);for(n=0;n<r&&t[n]===e[n];n++);return this.substitutionPenalty*(t.length+e.length-r-n)});const u=t.map(t=>t.toLowerCase().trim());this.targetSequence=u,void 0===a&&(a=1e3),this.aligner=new r.Alignment(this.targetSequence,this.prefixDistance,this.wordInsertionPenalty,this.wordDeletionPenalty,a),this.targetTimestamps=e,this.deletionPenalty=i,this.substitutionPenalty=s,this.insertionPenalty=n,this.insertBetweenParagraphsPenalty=o}static string2array(t){return t.split(/(?=[\s\S])/u)}static string2words(t){return t.replace(/\n/g,"\n ").split(/[ ]/u)}static cleanWords(e){return e.map(e=>t.cleanWord(e))}distortWords(t,e){let n;n=[];for(var r=0;r<t.length;r++)Math.random()<e/3?n.push(t[Math.floor(Math.random()*t.length)]):n.push(t[r]),Math.random()<e/3&&n.pop(),Math.random()<e/3&&n.push(t[Math.floor(Math.random()*t.length)]);return n}timeToIndex(t){const e=this.targetTimestamps.findIndex(e=>e[0]>=t);return-1===e?this.targetTimestamps.length:e}compareSequence(t,e,n){const r=t.map(t=>t.toLowerCase()),{distance:i,matchIndices:s}=this.aligner.match(["\n",...r,"\n"],this.timeToIndex(e),this.timeToIndex(n));return s.slice(1,s.length-1)}applyTimestamps(t,e){const n=new i.Transcription;for(let r=0;r<t.length;r+=1){const i=t[r]+" ",s=e[r],o=this.targetTimestamps[s][0],a=this.targetTimestamps[s][1];n.loadPhraseRaw(i,o,a)}return n}static cleanWord(t){let e=t.toLowerCase().trim();return e=e.replace(/[.,?]/g,"")}addNewWord(e,n,r){this.aligner.push(t.cleanWord(e)),this.targetTimestamps.push([n,r])}}return t.exactMatchDistance=((t,e)=>t===e?1:0),t})();e.StringAligner=s,t.exports={StringAligner:s,Alignment:r.Alignment}},function(t,e){t.exports=require("fs")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(10),i=n(3),s=n(11);5!==process.argv.length&&(console.log("usage: node "+process.argv[1]+" source target output"),console.log("target is a trsx file, source is a trsx or txt file. Output is a trsx file that will be created"),process.exit());const o=process.argv[2],a=process.argv[3],u=process.argv[4];function c(t){return s.readFileSync(t,"utf8")}const l=c(a),h=new i.Transcription(l,!0),d=h.words.map(t=>r.StringAligner.cleanWord(t));let f=null;if(o.endsWith(".txt"))f=c(o);else if(o.endsWith(".trsx")){const t=c(o);f=new i.Transcription(t).getText()}else console.error("provide txt or trsx source"),process.exit();const m=new r.StringAligner(d,h.timestamps,1,1,1,.9,4e3);let p;p=r.StringAligner.string2words(f);const g=r.StringAligner.cleanWords(p),v=m.compareSequence(g,0,1e9),w=m.applyTimestamps(p,v).exportTrsx();s.writeFile(u,w,function(t){t&&console.log(t)})}])});
//# sourceMappingURL=align_files.bundle.js.map